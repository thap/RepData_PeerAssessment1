---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data


```r
unzip("activity.zip")
data <- read.csv("activity.csv")
```

## What is mean total number of steps taken per day?


```r
# 1
totalsteps <- tapply(data$steps,data$date,sum,na.rm=T)
hist(totalsteps)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-21.png) 

```r
# 2
meansteps <- tapply(data$steps,data$date,mean,na.rm=T)
hist(meansteps)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-22.png) 

```r
mediansteps <- tapply(data$steps,data$date,median,na.rm=T)
hist(mediansteps)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-23.png) 

```r
print("All the medians are 0 or NA")
```

```
## [1] "All the medians are 0 or NA"
```

## What is the average daily activity pattern?


```r
# 1
intervals <- factor(data$interval)
averagesteps <- tapply(data$steps,intervals,mean,na.rm=T)
intervals <- as.integer(names(averagesteps))
plot(intervals,averagesteps,type="l",xlab="5-minute interval",ylab="average number of steps")
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3.png) 

```r
# 2
print("Which 5-minute interval contains the maximum number of steps?")
```

```
## [1] "Which 5-minute interval contains the maximum number of steps?"
```

```r
which.max(averagesteps)
```

```
## 835 
## 104
```

## Imputing missing values


```r
# 1
print("The total number of missing values in the dataset:")
```

```
## [1] "The total number of missing values in the dataset:"
```

```r
sum(!complete.cases(data))
```

```
## [1] 2304
```

```r
# 2 The strategy is to fill in the mean number of steps in the same interval across all date
# 3
ndates <- nrow(data)/length(averagesteps)
repavgsteps <- rep(averagesteps,times=ndates)
for(i in 1:nrow(data)) {
    if(is.na(data$steps[i])) {
        data$steps[i] <- repavgsteps[i]
    }
}
# 4
totalsteps <- tapply(data$steps,data$date,sum,na.rm=T)
hist(totalsteps)
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-41.png) 

```r
print("There are more days with 10000-15000 total number of steps and less days with other numbers of total steps")
```

```
## [1] "There are more days with 10000-15000 total number of steps and less days with other numbers of total steps"
```

```r
meansteps <- tapply(data$steps,data$date,mean,na.rm=T)
hist(meansteps)
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-42.png) 

```r
print("There are more days with 30-40 mean number of steps and less days with other mean numbers of steps")
```

```
## [1] "There are more days with 30-40 mean number of steps and less days with other mean numbers of steps"
```

```r
mediansteps <- tapply(data$steps,data$date,median,na.rm=T)
hist(mediansteps)
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-43.png) 

```r
print("There are mostly days with 0-5 median number of steps and some days with 30-35 median number of steps")
```

```
## [1] "There are mostly days with 0-5 median number of steps and some days with 30-35 median number of steps"
```

## Are there differences in activity patterns between weekdays and weekends?


```r
wday <- weekdays(as.Date(data$date))
wdaywend <- rep(NA,nrow(data))
for(i in 1:nrow(data)) {
    wdaywend[i] <- if(wday[i]=="Saturday"|wday[i]=="Sunday"){
        "weekend"
    }
    else {
        "weekday"
    }
}
newdata <- split(data,wdaywend)
calavgsteps <- function(data) {
    intervals <- factor(data$interval)
    tapply(data$steps,intervals,mean,na.rm=T)
}
data2 <- sapply(newdata,calavgsteps)
data2
```

```
##        weekday   weekend
## 0      2.25115 2.146e-01
## 5      0.44528 4.245e-02
## 10     0.17317 1.651e-02
## 15     0.19790 1.887e-02
## 20     0.09895 9.434e-03
## 25     1.59036 3.512e+00
## 30     0.69266 6.604e-02
## 35     1.13795 1.085e-01
## 40     0.00000 0.000e+00
## 45     1.79623 5.590e-01
## 50     0.39581 3.774e-02
## 55     0.01761 4.540e-01
## 100    0.42055 4.009e-02
## 105    0.09057 2.335e+00
## 110    0.19790 1.887e-02
## 115    0.44528 4.245e-02
## 120    0.00000 0.000e+00
## 125    1.45954 1.392e-01
## 130    2.22180 7.288e-01
## 135    0.02264 5.837e-01
## 140    0.22264 2.123e-02
## 145    0.25031 7.347e-01
## 150    0.34633 3.302e-02
## 155    0.00000 0.000e+00
## 200    0.00000 0.000e+00
## 205    0.00000 0.000e+00
## 210    1.39539 3.915e-01
## 215    0.00000 0.000e+00
## 220    0.00000 0.000e+00
## 225    0.17317 1.651e-02
## 230    0.00000 0.000e+00
## 235    0.29686 2.830e-02
## 240    0.00000 0.000e+00
## 245    0.00000 0.000e+00
## 250    2.02851 1.934e-01
## 255    1.23690 1.179e-01
## 300    0.00000 0.000e+00
## 305    0.00000 0.000e+00
## 310    0.00000 0.000e+00
## 315    0.00000 0.000e+00
## 320    0.02767 7.134e-01
## 325    0.81635 7.783e-02
## 330    1.23857 2.703e+00
## 335    0.52243 7.606e-01
## 340    0.42096 6.863e-01
## 345    0.09895 9.434e-03
## 350    0.00000 0.000e+00
## 355    0.00000 0.000e+00
## 400    0.26960 3.774e+00
## 405    1.23690 1.179e-01
## 410    2.23103 3.508e+00
## 415    0.00000 0.000e+00
## 420    0.44528 4.245e-02
## 425    0.04780 1.232e+00
## 430    3.37065 6.202e+00
## 435    0.22138 1.895e+00
## 440    3.77652 2.686e+00
## 445    0.88847 6.663e-01
## 450    2.34843 5.264e+00
## 455    0.72621 2.202e+00
## 500    0.00000 0.000e+00
## 505    2.05325 1.958e-01
## 510    3.93333 3.750e-01
## 515    2.18826 2.406e+00
## 520    4.22055 7.901e-01
## 525    2.70608 3.683e+00
## 530    2.74591 2.618e-01
## 535    7.94088 7.571e-01
## 540   20.40252 3.690e+00
## 545   23.64528 3.417e+00
## 550   50.34927 8.807e+00
## 555   56.26541 1.137e+01
## 600   41.28763 3.936e+00
## 605   64.59078 6.158e+00
## 610   70.08092 7.909e+00
## 615   77.14927 2.493e+01
## 620   63.92830 1.068e+01
## 625   60.03229 1.063e+01
## 630   66.44235 1.196e+01
## 635   47.97862 1.504e+01
## 640   55.66918 1.125e+01
## 645   54.86709 1.408e+01
## 650   47.04780 1.011e+01
## 655   60.42725 1.700e+01
## 700   50.59706 2.473e+01
## 705   50.82809 2.623e+01
## 710   62.02348 1.813e+01
## 715   69.33459 1.281e+01
## 720   63.10105 1.287e+01
## 725   59.10860 2.812e+01
## 730   66.22390 2.602e+01
## 735   54.35388 1.610e+01
## 740   62.72411 2.285e+01
## 745   83.38407 3.063e+01
## 750   67.73543 3.004e+01
## 755   66.57568 2.683e+01
## 800   82.71698 4.711e+01
## 805   71.96101 5.765e+01
## 810  144.01342 8.843e+01
## 815  181.98155 8.875e+01
## 820  200.57568 8.839e+01
## 825  183.60839 7.605e+01
## 830  198.88470 1.166e+02
## 835  230.37820 1.381e+02
## 840  218.90105 1.313e+02
## 845  185.65325 1.624e+02
## 850  191.23061 1.614e+02
## 855  177.09140 1.387e+02
## 900  167.66038 7.537e+01
## 905  125.78281 1.191e+02
## 910   93.94843 1.518e+02
## 915   87.30398 1.666e+02
## 920  103.54004 1.042e+02
## 925   92.46164 1.058e+02
## 930   58.51656 8.784e+01
## 935   35.85241 7.159e+01
## 940   27.46122 1.729e+01
## 945   40.85618 3.284e+01
## 950   39.13082 2.331e+01
## 955   17.62977 3.069e+01
## 1000  37.87547 4.813e+01
## 1005  18.21971 5.162e+01
## 1010  39.07757 5.180e+01
## 1015  47.82138 6.627e+01
## 1020  30.34549 6.305e+01
## 1025  35.15010 9.479e+01
## 1030  33.12662 7.566e+01
## 1035  24.25535 7.443e+01
## 1040  23.51530 6.615e+01
## 1045  25.91195 3.517e+01
## 1050  22.03480 3.370e+01
## 1055  23.25912 5.637e+01
## 1100  21.69224 5.854e+01
## 1105  25.09057 4.258e+01
## 1110  11.68721 4.842e+01
## 1115  16.27296 5.163e+01
## 1120  24.18365 4.017e+01
## 1125  23.72956 3.418e+01
## 1130  32.76897 3.530e+01
## 1135  50.19748 4.937e+01
## 1140  44.56059 3.494e+01
## 1145  47.92495 3.526e+01
## 1150  50.11614 3.457e+01
## 1155  56.13627 6.777e+01
## 1200  55.71572 8.680e+01
## 1205  72.84864 1.295e+02
## 1210  83.64654 1.264e+02
## 1215  75.28092 1.420e+02
## 1220  48.71950 1.047e+02
## 1225  46.82264 5.958e+01
## 1230  62.57400 3.168e+01
## 1235  30.74423 3.711e+01
## 1240  21.98155 3.932e+01
## 1245  29.32034 6.140e+01
## 1250  32.78532 7.957e+01
## 1255  56.59329 9.735e+01
## 1300  24.60084 9.223e+01
## 1305  25.74046 7.967e+01
## 1310  24.56855 9.585e+01
## 1315  15.64193 1.122e+02
## 1320  35.63270 7.609e+01
## 1325  44.85786 8.899e+01
## 1330  31.76730 7.366e+01
## 1335  23.30650 3.027e+01
## 1340  25.23941 8.137e+01
## 1345  40.18407 9.113e+01
## 1350  25.57610 1.085e+02
## 1355  36.33040 1.297e+02
## 1400  46.92285 8.059e+01
## 1405  39.55052 8.687e+01
## 1410  32.12243 7.582e+01
## 1415  45.04864 5.896e+01
## 1420  27.48512 5.793e+01
## 1425  30.76184 5.663e+01
## 1430  31.49099 7.098e+01
## 1435  14.51237 6.406e+01
## 1440  11.54843 3.276e+01
## 1445  21.98784 3.757e+01
## 1450  41.86080 4.858e+01
## 1455  38.28092 5.922e+01
## 1500  30.86918 2.763e+01
## 1505  35.05451 3.895e+01
## 1510  29.95430 5.106e+01
## 1515  31.91321 5.836e+01
## 1520  39.86164 6.312e+01
## 1525  37.34507 7.703e+01
## 1530  42.12872 6.502e+01
## 1535  50.93166 1.058e+02
## 1540  90.56520 6.136e+01
## 1545  95.86583 1.065e+02
## 1550  93.94843 1.251e+02
## 1555  70.30608 1.224e+02
## 1600  46.88428 1.050e+02
## 1605  45.19539 1.174e+02
## 1610  56.60629 1.250e+02
## 1615  36.13375 1.392e+02
## 1620  26.80964 1.416e+02
## 1625  29.52537 1.448e+02
## 1630  22.51572 1.039e+02
## 1635  21.83103 8.563e+01
## 1640  25.86583 9.752e+01
## 1645  31.99371 8.331e+01
## 1650  27.62767 9.846e+01
## 1655  32.42390 7.533e+01
## 1700  23.57191 1.115e+02
## 1705  44.95136 8.823e+01
## 1710  34.18449 9.721e+01
## 1715  48.07463 9.822e+01
## 1720  60.11782 1.082e+02
## 1725  72.37023 9.743e+01
## 1730  56.14801 1.049e+02
## 1735  65.82138 4.233e+01
## 1740  82.87925 5.320e+01
## 1745  59.33459 4.856e+01
## 1750  34.50314 3.553e+01
## 1755  37.59371 3.706e+01
## 1800  26.64612 8.015e+01
## 1805  46.62474 9.006e+01
## 1810  67.22642 9.571e+01
## 1815  82.64277 9.285e+01
## 1820  61.39078 5.328e+01
## 1825  73.45870 5.178e+01
## 1830  79.22642 7.340e+01
## 1835  81.49937 5.384e+01
## 1840  91.71195 6.742e+01
## 1845 115.46038 5.443e+01
## 1850 101.30021 4.520e+01
## 1855  90.59161 7.158e+01
## 1900  87.56017 7.730e+01
## 1905  77.22180 7.954e+01
## 1910  62.38281 4.582e+01
## 1915  54.38113 5.048e+01
## 1920  37.88721 3.192e+01
## 1925  20.56226 2.115e+01
## 1930  29.09727 2.261e+01
## 1935  45.98029 2.325e+01
## 1940  30.04990 3.065e+01
## 1945  18.58407 4.513e+01
## 1950  44.26583 4.958e+01
## 1955  27.29266 5.107e+01
## 2000  13.39413 3.714e+01
## 2005   5.55807 5.688e+01
## 2010   6.82306 5.454e+01
## 2015  14.11195 8.742e+01
## 2020   8.70818 7.773e+01
## 2025   5.71153 6.465e+01
## 2030   9.77358 7.660e+01
## 2035   7.15639 6.123e+01
## 2040   8.96184 4.932e+01
## 2045  13.10943 4.442e+01
## 2050  25.97358 5.010e+01
## 2055  17.30901 2.814e+01
## 2100  11.37023 2.881e+01
## 2105  18.89686 1.253e+01
## 2110  28.50482 9.244e+00
## 2115  18.94382 2.009e+01
## 2120  14.28260 7.307e+00
## 2125   8.04696 7.940e+00
## 2130  12.79916 1.990e+01
## 2135  16.50692 1.573e+01
## 2140   7.13501 1.302e+01
## 2145   7.59455 8.349e+00
## 2150   8.26205 7.767e+00
## 2155   3.43857 3.278e-01
## 2200   1.52704 1.244e+00
## 2205   4.42390 1.585e+00
## 2210   6.30818 6.014e-01
## 2215  11.15681 1.064e+00
## 2220   9.27673 8.844e-01
## 2225  10.84864 2.650e+00
## 2230  12.78952 1.219e+00
## 2235   2.89434 2.759e-01
## 2240   0.04277 1.103e+00
## 2245   0.14843 1.415e-02
## 2250   1.90273 7.630e-01
## 2255   2.01384 1.189e+01
## 2300   3.55136 2.600e+00
## 2305   3.73543 3.561e-01
## 2310   0.00000 0.000e+00
## 2315   1.08847 1.038e-01
## 2320   1.26164 1.203e-01
## 2325   1.87799 7.606e-01
## 2330   3.03606 1.388e+00
## 2335   2.24864 1.159e+01
## 2340   2.24025 6.288e+00
## 2345   0.26331 1.705e+00
## 2350   0.29686 2.830e-02
## 2355   1.41006 1.344e-01
```
